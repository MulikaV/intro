{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport { success, error, abort, isSuccessAction, isResponseAction, getRequestActionFromResponse } from '../actions';\nimport mutationsReducer from './mutations-reducer';\nimport defaultConfig from './default-config'; // to support libraries like redux-act and redux-actions\n\nvar normalizeActionType = function normalizeActionType(actionType) {\n  return typeof actionType === 'function' ? actionType.toString() : actionType;\n};\n\nvar mutationConfigHasRequestKey = function mutationConfigHasRequestKey(config) {\n  return typeof config !== 'boolean' && !!config.getRequestKey;\n};\n\nvar getInitialState = function getInitialState(_ref) {\n  var getDefaultData = _ref.getDefaultData,\n      multiple = _ref.multiple,\n      mutations = _ref.mutations,\n      handleMutationsState = _ref.handleMutationsState;\n  return {\n    data: getDefaultData(multiple),\n    pending: 0,\n    error: null,\n    mutations: handleMutationsState && mutations ? Object.entries(mutations).filter(function (_ref2) {\n      var v = _ref2[1];\n      return !v.local;\n    }).reduce(function (prev, _ref3) {\n      var _extends2;\n\n      var k = _ref3[0],\n          v = _ref3[1];\n      return _extends({}, prev, (_extends2 = {}, _extends2[k] = mutationConfigHasRequestKey(v) ? {} : {\n        error: null,\n        pending: 0\n      }, _extends2));\n    }, {}) : null\n  };\n};\n\nvar getDataUpdater = function getDataUpdater(reducerConfig, mutationConfig) {\n  if (mutationConfig === true || mutationConfig.updateData === true) {\n    return reducerConfig.updateData || reducerConfig.getData;\n  } else if (typeof mutationConfig === 'function') {\n    return mutationConfig;\n  } else if (typeof mutationConfig !== 'boolean' && typeof mutationConfig.updateData === 'function') {\n    return mutationConfig.updateData;\n  }\n\n  return null;\n};\n\nvar requestMutationReducer = function requestMutationReducer(state, action, config) {\n  var mutationConfig = config.mutations[action.type];\n\n  if (mutationConfig.updateDataOptimistic) {\n    return _extends({}, state, {\n      data: mutationConfig.updateDataOptimistic(state, action, config)\n    });\n  }\n\n  if (mutationConfig.local) {\n    var dataUpdater = getDataUpdater(config, mutationConfig);\n    return _extends({}, state, {\n      data: dataUpdater(state, action, config)\n    });\n  }\n\n  return state;\n};\n\nvar responseMutationReducer = function responseMutationReducer(state, action, config) {\n  var requestAction = getRequestActionFromResponse(action);\n  var mutationConfig = config.mutations[requestAction.type];\n\n  if (isSuccessAction(action)) {\n    var dataUpdater = getDataUpdater(config, mutationConfig);\n    return dataUpdater ? _extends({}, state, {\n      data: dataUpdater(state, action, config)\n    }) : state;\n  } // error or abort case\n\n\n  return mutationConfig.revertData ? _extends({}, state, {\n    data: mutationConfig.revertData(state, action, config)\n  }) : state;\n};\n\nexport default (function (localConfig) {\n  var config = _extends({}, defaultConfig, {}, localConfig);\n\n  var normalizedActionType = normalizeActionType(config.actionType);\n  var shouldActionBeReset = typeof config.resetOn === 'function' ? config.resetOn : function (action) {\n    return config.resetOn.map(normalizeActionType).includes(action.type);\n  };\n  return function (state, action) {\n    if (action.meta && action.meta.mutations && normalizedActionType in action.meta.mutations && (!config.mutations || !(normalizedActionType in config.mutations))) {\n      var _extends3;\n\n      config.mutations = _extends({}, config.mutations, (_extends3 = {}, _extends3[action.type] = action.meta.mutations[normalizedActionType], _extends3));\n    }\n\n    var nextState = state || getInitialState(config);\n\n    if (shouldActionBeReset(action)) {\n      nextState = _extends({}, getInitialState(config), {\n        pending: nextState.pending\n      });\n    }\n\n    var requestAction = isResponseAction(action) ? getRequestActionFromResponse(action) : action;\n\n    if (config.mutations && requestAction.type in config.mutations) {\n      return _extends({}, isResponseAction(action) ? responseMutationReducer(nextState, action, config) : requestMutationReducer(nextState, action, config), {\n        mutations: config.handleMutationsState ? mutationsReducer(nextState.mutations, action, config, config.mutations[requestAction.type]) : null\n      });\n    }\n\n    switch (action.type) {\n      case normalizedActionType:\n        return config.onRequest(nextState, action, config);\n\n      case success(normalizedActionType):\n        return config.onSuccess(nextState, action, config);\n\n      case error(normalizedActionType):\n        return config.onError(nextState, action, config);\n\n      case abort(normalizedActionType):\n        return config.onAbort(nextState, action, config);\n\n      default:\n        return nextState;\n    }\n  };\n});","map":{"version":3,"sources":["/var/www/sites/Intro/node_modules/redux-saga-requests/es/reducers/requests-reducer.js"],"names":["_extends","success","error","abort","isSuccessAction","isResponseAction","getRequestActionFromResponse","mutationsReducer","defaultConfig","normalizeActionType","actionType","toString","mutationConfigHasRequestKey","config","getRequestKey","getInitialState","_ref","getDefaultData","multiple","mutations","handleMutationsState","data","pending","Object","entries","filter","_ref2","v","local","reduce","prev","_ref3","_extends2","k","getDataUpdater","reducerConfig","mutationConfig","updateData","getData","requestMutationReducer","state","action","type","updateDataOptimistic","dataUpdater","responseMutationReducer","requestAction","revertData","localConfig","normalizedActionType","shouldActionBeReset","resetOn","map","includes","meta","_extends3","nextState","onRequest","onSuccess","onError","onAbort"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/extends\";\nimport { success, error, abort, isSuccessAction, isResponseAction, getRequestActionFromResponse } from '../actions';\nimport mutationsReducer from './mutations-reducer';\nimport defaultConfig from './default-config'; // to support libraries like redux-act and redux-actions\n\nvar normalizeActionType = function normalizeActionType(actionType) {\n  return typeof actionType === 'function' ? actionType.toString() : actionType;\n};\n\nvar mutationConfigHasRequestKey = function mutationConfigHasRequestKey(config) {\n  return typeof config !== 'boolean' && !!config.getRequestKey;\n};\n\nvar getInitialState = function getInitialState(_ref) {\n  var getDefaultData = _ref.getDefaultData,\n      multiple = _ref.multiple,\n      mutations = _ref.mutations,\n      handleMutationsState = _ref.handleMutationsState;\n  return {\n    data: getDefaultData(multiple),\n    pending: 0,\n    error: null,\n    mutations: handleMutationsState && mutations ? Object.entries(mutations).filter(function (_ref2) {\n      var v = _ref2[1];\n      return !v.local;\n    }).reduce(function (prev, _ref3) {\n      var _extends2;\n\n      var k = _ref3[0],\n          v = _ref3[1];\n      return _extends({}, prev, (_extends2 = {}, _extends2[k] = mutationConfigHasRequestKey(v) ? {} : {\n        error: null,\n        pending: 0\n      }, _extends2));\n    }, {}) : null\n  };\n};\n\nvar getDataUpdater = function getDataUpdater(reducerConfig, mutationConfig) {\n  if (mutationConfig === true || mutationConfig.updateData === true) {\n    return reducerConfig.updateData || reducerConfig.getData;\n  } else if (typeof mutationConfig === 'function') {\n    return mutationConfig;\n  } else if (typeof mutationConfig !== 'boolean' && typeof mutationConfig.updateData === 'function') {\n    return mutationConfig.updateData;\n  }\n\n  return null;\n};\n\nvar requestMutationReducer = function requestMutationReducer(state, action, config) {\n  var mutationConfig = config.mutations[action.type];\n\n  if (mutationConfig.updateDataOptimistic) {\n    return _extends({}, state, {\n      data: mutationConfig.updateDataOptimistic(state, action, config)\n    });\n  }\n\n  if (mutationConfig.local) {\n    var dataUpdater = getDataUpdater(config, mutationConfig);\n    return _extends({}, state, {\n      data: dataUpdater(state, action, config)\n    });\n  }\n\n  return state;\n};\n\nvar responseMutationReducer = function responseMutationReducer(state, action, config) {\n  var requestAction = getRequestActionFromResponse(action);\n  var mutationConfig = config.mutations[requestAction.type];\n\n  if (isSuccessAction(action)) {\n    var dataUpdater = getDataUpdater(config, mutationConfig);\n    return dataUpdater ? _extends({}, state, {\n      data: dataUpdater(state, action, config)\n    }) : state;\n  } // error or abort case\n\n\n  return mutationConfig.revertData ? _extends({}, state, {\n    data: mutationConfig.revertData(state, action, config)\n  }) : state;\n};\n\nexport default (function (localConfig) {\n  var config = _extends({}, defaultConfig, {}, localConfig);\n\n  var normalizedActionType = normalizeActionType(config.actionType);\n  var shouldActionBeReset = typeof config.resetOn === 'function' ? config.resetOn : function (action) {\n    return config.resetOn.map(normalizeActionType).includes(action.type);\n  };\n  return function (state, action) {\n    if (action.meta && action.meta.mutations && normalizedActionType in action.meta.mutations && (!config.mutations || !(normalizedActionType in config.mutations))) {\n      var _extends3;\n\n      config.mutations = _extends({}, config.mutations, (_extends3 = {}, _extends3[action.type] = action.meta.mutations[normalizedActionType], _extends3));\n    }\n\n    var nextState = state || getInitialState(config);\n\n    if (shouldActionBeReset(action)) {\n      nextState = _extends({}, getInitialState(config), {\n        pending: nextState.pending\n      });\n    }\n\n    var requestAction = isResponseAction(action) ? getRequestActionFromResponse(action) : action;\n\n    if (config.mutations && requestAction.type in config.mutations) {\n      return _extends({}, isResponseAction(action) ? responseMutationReducer(nextState, action, config) : requestMutationReducer(nextState, action, config), {\n        mutations: config.handleMutationsState ? mutationsReducer(nextState.mutations, action, config, config.mutations[requestAction.type]) : null\n      });\n    }\n\n    switch (action.type) {\n      case normalizedActionType:\n        return config.onRequest(nextState, action, config);\n\n      case success(normalizedActionType):\n        return config.onSuccess(nextState, action, config);\n\n      case error(normalizedActionType):\n        return config.onError(nextState, action, config);\n\n      case abort(normalizedActionType):\n        return config.onAbort(nextState, action, config);\n\n      default:\n        return nextState;\n    }\n  };\n});"]},"metadata":{},"sourceType":"module"}