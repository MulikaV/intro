{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _extends from \"@babel/runtime/helpers/extends\";\n\nvar _marked =\n/*#__PURE__*/\n_regeneratorRuntime.mark(sendRequest);\n\nimport { call, put, all, cancelled, getContext, setContext } from 'redux-saga/effects';\nimport { createSuccessAction, createErrorAction, createAbortAction, getActionPayload, isRequestAction } from '../actions';\nimport { INCORRECT_PAYLOAD_ERROR, RUN_BY_INTERCEPTOR, INTERCEPTORS } from '../constants';\nimport { getRequestsConfig } from './get-request-instance';\n\nvar getDriver = function getDriver(requestsConfig, action) {\n  return action.meta && action.meta.driver ? requestsConfig.driver[action.meta.driver] : requestsConfig.driver[\"default\"] || requestsConfig.driver;\n};\n\nexport default function sendRequest(action, _temp) {\n  var _ref, _ref$dispatchRequestA, dispatchRequestAction, _ref$silent, silent, _ref$runOnRequest, runOnRequest, _ref$runOnSuccess, runOnSuccess, _ref$runOnError, runOnError, _ref$runOnAbort, runOnAbort, runByInterceptor, requestsConfig, driver, actionPayload, _setContext, abortSource, response, responseError, _setContext2, _ref2, onErrorResponse, onErrorError, errorPayload, _setContext3, successPayload, _setContext4;\n\n  return _regeneratorRuntime.wrap(function sendRequest$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _ref = _temp === void 0 ? {} : _temp, _ref$dispatchRequestA = _ref.dispatchRequestAction, dispatchRequestAction = _ref$dispatchRequestA === void 0 ? false : _ref$dispatchRequestA, _ref$silent = _ref.silent, silent = _ref$silent === void 0 ? false : _ref$silent, _ref$runOnRequest = _ref.runOnRequest, runOnRequest = _ref$runOnRequest === void 0 ? null : _ref$runOnRequest, _ref$runOnSuccess = _ref.runOnSuccess, runOnSuccess = _ref$runOnSuccess === void 0 ? null : _ref$runOnSuccess, _ref$runOnError = _ref.runOnError, runOnError = _ref$runOnError === void 0 ? null : _ref$runOnError, _ref$runOnAbort = _ref.runOnAbort, runOnAbort = _ref$runOnAbort === void 0 ? null : _ref$runOnAbort;\n\n          if (isRequestAction(action)) {\n            _context.next = 3;\n            break;\n          }\n\n          throw new Error(INCORRECT_PAYLOAD_ERROR);\n\n        case 3:\n          _context.next = 5;\n          return getContext(RUN_BY_INTERCEPTOR);\n\n        case 5:\n          runByInterceptor = _context.sent;\n          _context.next = 8;\n          return getRequestsConfig();\n\n        case 8:\n          requestsConfig = _context.sent;\n\n          if (!(dispatchRequestAction && !silent)) {\n            _context.next = 16;\n            break;\n          }\n\n          action = _extends({}, action, {\n            meta: _extends({}, action.meta, {\n              runByWatcher: false\n            })\n          });\n          _context.next = 13;\n          return put(action);\n\n        case 13:\n          action = _context.sent;\n\n          if (!(action === null)) {\n            _context.next = 16;\n            break;\n          }\n\n          return _context.abrupt(\"return\", {\n            serverSide: true\n          });\n\n        case 16:\n          _context.next = 18;\n          return call(getDriver, requestsConfig, action);\n\n        case 18:\n          driver = _context.sent;\n          actionPayload = getActionPayload(action);\n\n          if (!(requestsConfig.onRequest && (runOnRequest !== null ? runOnRequest : runByInterceptor !== INTERCEPTORS.ON_REQUEST))) {\n            _context.next = 26;\n            break;\n          }\n\n          _context.next = 23;\n          return setContext((_setContext = {}, _setContext[RUN_BY_INTERCEPTOR] = INTERCEPTORS.ON_REQUEST, _setContext));\n\n        case 23:\n          _context.next = 25;\n          return call(requestsConfig.onRequest, actionPayload.request, action);\n\n        case 25:\n          actionPayload.request = _context.sent;\n\n        case 26:\n          abortSource = driver.getAbortSource();\n          _context.prev = 27;\n          _context.prev = 28;\n\n          if (!(action.meta && action.meta.cacheResponse)) {\n            _context.next = 33;\n            break;\n          }\n\n          response = action.meta.cacheResponse;\n          _context.next = 42;\n          break;\n\n        case 33:\n          if (Array.isArray(actionPayload.request)) {\n            _context.next = 39;\n            break;\n          }\n\n          _context.next = 36;\n          return call([driver, 'sendRequest'], actionPayload.request, abortSource, action);\n\n        case 36:\n          response = _context.sent;\n          _context.next = 42;\n          break;\n\n        case 39:\n          _context.next = 41;\n          return all(actionPayload.request.map(function (requestItem) {\n            return call([driver, 'sendRequest'], requestItem, abortSource, action);\n          }));\n\n        case 41:\n          response = _context.sent;\n\n        case 42:\n          _context.next = 47;\n          break;\n\n        case 44:\n          _context.prev = 44;\n          _context.t0 = _context[\"catch\"](28);\n          responseError = _context.t0;\n\n        case 47:\n          if (!responseError) {\n            _context.next = 65;\n            break;\n          }\n\n          if (!(requestsConfig.onError && (runOnError !== null ? runOnError : runByInterceptor !== INTERCEPTORS.ON_ERROR))) {\n            _context.next = 57;\n            break;\n          }\n\n          _context.next = 51;\n          return setContext((_setContext2 = {}, _setContext2[RUN_BY_INTERCEPTOR] = INTERCEPTORS.ON_ERROR, _setContext2));\n\n        case 51:\n          _context.next = 53;\n          return call(requestsConfig.onError, responseError, action);\n\n        case 53:\n          _ref2 = _context.sent;\n          onErrorResponse = _ref2.response;\n          onErrorError = _ref2.error;\n\n          if (onErrorResponse) {\n            response = onErrorResponse;\n          } else {\n            responseError = onErrorError;\n          }\n\n        case 57:\n          if (response) {\n            _context.next = 65;\n            break;\n          }\n\n          _context.next = 60;\n          return call(driver.getErrorPayload, responseError);\n\n        case 60:\n          errorPayload = _context.sent;\n\n          if (silent) {\n            _context.next = 64;\n            break;\n          }\n\n          _context.next = 64;\n          return put(createErrorAction(action, errorPayload));\n\n        case 64:\n          return _context.abrupt(\"return\", {\n            error: responseError\n          });\n\n        case 65:\n          if (!(requestsConfig.onSuccess && (runOnSuccess !== null ? runOnSuccess : runByInterceptor !== INTERCEPTORS.ON_SUCCESS && runByInterceptor !== INTERCEPTORS.ON_ERROR))) {\n            _context.next = 71;\n            break;\n          }\n\n          _context.next = 68;\n          return setContext((_setContext3 = {}, _setContext3[RUN_BY_INTERCEPTOR] = INTERCEPTORS.ON_SUCCESS, _setContext3));\n\n        case 68:\n          _context.next = 70;\n          return call(requestsConfig.onSuccess, response, action);\n\n        case 70:\n          response = _context.sent;\n\n        case 71:\n          _context.next = 73;\n          return call(driver.getSuccessPayload, response, actionPayload.request);\n\n        case 73:\n          successPayload = _context.sent;\n\n          if (silent) {\n            _context.next = 77;\n            break;\n          }\n\n          _context.next = 77;\n          return put(createSuccessAction(action, successPayload, response));\n\n        case 77:\n          return _context.abrupt(\"return\", {\n            response: response\n          });\n\n        case 78:\n          _context.prev = 78;\n          _context.next = 81;\n          return cancelled();\n\n        case 81:\n          if (!_context.sent) {\n            _context.next = 92;\n            break;\n          }\n\n          _context.next = 84;\n          return call([driver, 'abortRequest'], abortSource);\n\n        case 84:\n          if (!(requestsConfig.onAbort && (runOnAbort !== null ? runOnAbort : runByInterceptor !== INTERCEPTORS.ON_ABORT))) {\n            _context.next = 89;\n            break;\n          }\n\n          _context.next = 87;\n          return setContext((_setContext4 = {}, _setContext4[RUN_BY_INTERCEPTOR] = INTERCEPTORS.ON_ABORT, _setContext4));\n\n        case 87:\n          _context.next = 89;\n          return call(requestsConfig.onAbort, action);\n\n        case 89:\n          if (silent) {\n            _context.next = 92;\n            break;\n          }\n\n          _context.next = 92;\n          return put(createAbortAction(action));\n\n        case 92:\n          return _context.finish(78);\n\n        case 93:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _marked, null, [[27,, 78, 93], [28, 44]]);\n}","map":{"version":3,"sources":["/var/www/sites/Intro/node_modules/redux-saga-requests/es/sagas/send-request.js"],"names":["_regeneratorRuntime","_extends","_marked","mark","sendRequest","call","put","all","cancelled","getContext","setContext","createSuccessAction","createErrorAction","createAbortAction","getActionPayload","isRequestAction","INCORRECT_PAYLOAD_ERROR","RUN_BY_INTERCEPTOR","INTERCEPTORS","getRequestsConfig","getDriver","requestsConfig","action","meta","driver","_temp","_ref","_ref$dispatchRequestA","dispatchRequestAction","_ref$silent","silent","_ref$runOnRequest","runOnRequest","_ref$runOnSuccess","runOnSuccess","_ref$runOnError","runOnError","_ref$runOnAbort","runOnAbort","runByInterceptor","actionPayload","_setContext","abortSource","response","responseError","_setContext2","_ref2","onErrorResponse","onErrorError","errorPayload","_setContext3","successPayload","_setContext4","wrap","sendRequest$","_context","prev","next","Error","sent","runByWatcher","abrupt","serverSide","onRequest","ON_REQUEST","request","getAbortSource","cacheResponse","Array","isArray","map","requestItem","t0","onError","ON_ERROR","error","getErrorPayload","onSuccess","ON_SUCCESS","getSuccessPayload","onAbort","ON_ABORT","finish","stop"],"mappings":"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","sourcesContent":["import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _extends from \"@babel/runtime/helpers/extends\";\n\nvar _marked =\n/*#__PURE__*/\n_regeneratorRuntime.mark(sendRequest);\n\nimport { call, put, all, cancelled, getContext, setContext } from 'redux-saga/effects';\nimport { createSuccessAction, createErrorAction, createAbortAction, getActionPayload, isRequestAction } from '../actions';\nimport { INCORRECT_PAYLOAD_ERROR, RUN_BY_INTERCEPTOR, INTERCEPTORS } from '../constants';\nimport { getRequestsConfig } from './get-request-instance';\n\nvar getDriver = function getDriver(requestsConfig, action) {\n  return action.meta && action.meta.driver ? requestsConfig.driver[action.meta.driver] : requestsConfig.driver[\"default\"] || requestsConfig.driver;\n};\n\nexport default function sendRequest(action, _temp) {\n  var _ref, _ref$dispatchRequestA, dispatchRequestAction, _ref$silent, silent, _ref$runOnRequest, runOnRequest, _ref$runOnSuccess, runOnSuccess, _ref$runOnError, runOnError, _ref$runOnAbort, runOnAbort, runByInterceptor, requestsConfig, driver, actionPayload, _setContext, abortSource, response, responseError, _setContext2, _ref2, onErrorResponse, onErrorError, errorPayload, _setContext3, successPayload, _setContext4;\n\n  return _regeneratorRuntime.wrap(function sendRequest$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _ref = _temp === void 0 ? {} : _temp, _ref$dispatchRequestA = _ref.dispatchRequestAction, dispatchRequestAction = _ref$dispatchRequestA === void 0 ? false : _ref$dispatchRequestA, _ref$silent = _ref.silent, silent = _ref$silent === void 0 ? false : _ref$silent, _ref$runOnRequest = _ref.runOnRequest, runOnRequest = _ref$runOnRequest === void 0 ? null : _ref$runOnRequest, _ref$runOnSuccess = _ref.runOnSuccess, runOnSuccess = _ref$runOnSuccess === void 0 ? null : _ref$runOnSuccess, _ref$runOnError = _ref.runOnError, runOnError = _ref$runOnError === void 0 ? null : _ref$runOnError, _ref$runOnAbort = _ref.runOnAbort, runOnAbort = _ref$runOnAbort === void 0 ? null : _ref$runOnAbort;\n\n          if (isRequestAction(action)) {\n            _context.next = 3;\n            break;\n          }\n\n          throw new Error(INCORRECT_PAYLOAD_ERROR);\n\n        case 3:\n          _context.next = 5;\n          return getContext(RUN_BY_INTERCEPTOR);\n\n        case 5:\n          runByInterceptor = _context.sent;\n          _context.next = 8;\n          return getRequestsConfig();\n\n        case 8:\n          requestsConfig = _context.sent;\n\n          if (!(dispatchRequestAction && !silent)) {\n            _context.next = 16;\n            break;\n          }\n\n          action = _extends({}, action, {\n            meta: _extends({}, action.meta, {\n              runByWatcher: false\n            })\n          });\n          _context.next = 13;\n          return put(action);\n\n        case 13:\n          action = _context.sent;\n\n          if (!(action === null)) {\n            _context.next = 16;\n            break;\n          }\n\n          return _context.abrupt(\"return\", {\n            serverSide: true\n          });\n\n        case 16:\n          _context.next = 18;\n          return call(getDriver, requestsConfig, action);\n\n        case 18:\n          driver = _context.sent;\n          actionPayload = getActionPayload(action);\n\n          if (!(requestsConfig.onRequest && (runOnRequest !== null ? runOnRequest : runByInterceptor !== INTERCEPTORS.ON_REQUEST))) {\n            _context.next = 26;\n            break;\n          }\n\n          _context.next = 23;\n          return setContext((_setContext = {}, _setContext[RUN_BY_INTERCEPTOR] = INTERCEPTORS.ON_REQUEST, _setContext));\n\n        case 23:\n          _context.next = 25;\n          return call(requestsConfig.onRequest, actionPayload.request, action);\n\n        case 25:\n          actionPayload.request = _context.sent;\n\n        case 26:\n          abortSource = driver.getAbortSource();\n          _context.prev = 27;\n          _context.prev = 28;\n\n          if (!(action.meta && action.meta.cacheResponse)) {\n            _context.next = 33;\n            break;\n          }\n\n          response = action.meta.cacheResponse;\n          _context.next = 42;\n          break;\n\n        case 33:\n          if (Array.isArray(actionPayload.request)) {\n            _context.next = 39;\n            break;\n          }\n\n          _context.next = 36;\n          return call([driver, 'sendRequest'], actionPayload.request, abortSource, action);\n\n        case 36:\n          response = _context.sent;\n          _context.next = 42;\n          break;\n\n        case 39:\n          _context.next = 41;\n          return all(actionPayload.request.map(function (requestItem) {\n            return call([driver, 'sendRequest'], requestItem, abortSource, action);\n          }));\n\n        case 41:\n          response = _context.sent;\n\n        case 42:\n          _context.next = 47;\n          break;\n\n        case 44:\n          _context.prev = 44;\n          _context.t0 = _context[\"catch\"](28);\n          responseError = _context.t0;\n\n        case 47:\n          if (!responseError) {\n            _context.next = 65;\n            break;\n          }\n\n          if (!(requestsConfig.onError && (runOnError !== null ? runOnError : runByInterceptor !== INTERCEPTORS.ON_ERROR))) {\n            _context.next = 57;\n            break;\n          }\n\n          _context.next = 51;\n          return setContext((_setContext2 = {}, _setContext2[RUN_BY_INTERCEPTOR] = INTERCEPTORS.ON_ERROR, _setContext2));\n\n        case 51:\n          _context.next = 53;\n          return call(requestsConfig.onError, responseError, action);\n\n        case 53:\n          _ref2 = _context.sent;\n          onErrorResponse = _ref2.response;\n          onErrorError = _ref2.error;\n\n          if (onErrorResponse) {\n            response = onErrorResponse;\n          } else {\n            responseError = onErrorError;\n          }\n\n        case 57:\n          if (response) {\n            _context.next = 65;\n            break;\n          }\n\n          _context.next = 60;\n          return call(driver.getErrorPayload, responseError);\n\n        case 60:\n          errorPayload = _context.sent;\n\n          if (silent) {\n            _context.next = 64;\n            break;\n          }\n\n          _context.next = 64;\n          return put(createErrorAction(action, errorPayload));\n\n        case 64:\n          return _context.abrupt(\"return\", {\n            error: responseError\n          });\n\n        case 65:\n          if (!(requestsConfig.onSuccess && (runOnSuccess !== null ? runOnSuccess : runByInterceptor !== INTERCEPTORS.ON_SUCCESS && runByInterceptor !== INTERCEPTORS.ON_ERROR))) {\n            _context.next = 71;\n            break;\n          }\n\n          _context.next = 68;\n          return setContext((_setContext3 = {}, _setContext3[RUN_BY_INTERCEPTOR] = INTERCEPTORS.ON_SUCCESS, _setContext3));\n\n        case 68:\n          _context.next = 70;\n          return call(requestsConfig.onSuccess, response, action);\n\n        case 70:\n          response = _context.sent;\n\n        case 71:\n          _context.next = 73;\n          return call(driver.getSuccessPayload, response, actionPayload.request);\n\n        case 73:\n          successPayload = _context.sent;\n\n          if (silent) {\n            _context.next = 77;\n            break;\n          }\n\n          _context.next = 77;\n          return put(createSuccessAction(action, successPayload, response));\n\n        case 77:\n          return _context.abrupt(\"return\", {\n            response: response\n          });\n\n        case 78:\n          _context.prev = 78;\n          _context.next = 81;\n          return cancelled();\n\n        case 81:\n          if (!_context.sent) {\n            _context.next = 92;\n            break;\n          }\n\n          _context.next = 84;\n          return call([driver, 'abortRequest'], abortSource);\n\n        case 84:\n          if (!(requestsConfig.onAbort && (runOnAbort !== null ? runOnAbort : runByInterceptor !== INTERCEPTORS.ON_ABORT))) {\n            _context.next = 89;\n            break;\n          }\n\n          _context.next = 87;\n          return setContext((_setContext4 = {}, _setContext4[RUN_BY_INTERCEPTOR] = INTERCEPTORS.ON_ABORT, _setContext4));\n\n        case 87:\n          _context.next = 89;\n          return call(requestsConfig.onAbort, action);\n\n        case 89:\n          if (silent) {\n            _context.next = 92;\n            break;\n          }\n\n          _context.next = 92;\n          return put(createAbortAction(action));\n\n        case 92:\n          return _context.finish(78);\n\n        case 93:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _marked, null, [[27,, 78, 93], [28, 44]]);\n}"]},"metadata":{},"sourceType":"module"}